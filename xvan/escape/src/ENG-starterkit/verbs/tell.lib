
$VERB tell
 SCOPE all_locs

 PROLOGUE
   if not(testflag(o_actor.f_alive)) then
     if trigger(o_actor.t_talk_to_dead) then
       disagree()
     endif
   endif

   if equal(o_subject, %none) then
     agree()
   endif

   if not(cansee(o_player, o_actor)) then
     printcr("[the] [o_actor] is not here.")
     disagree()
   endif

   if not(cansee(o_actor, o_subject)) then
     printcr("[the] [o_subject] is not here.")
     disagree()
   endif

 "[o_player], tell [o_subject] about [o_spec]"
   DISAMBIGUATION_RULES
     if equal(o_subject, o_nst) then score(-10) endif
     if equal(o_spec, o_nst) then score(-10) endif
     if testflag(o_spec.f_seenbefore) then score(5) endif
     if cansee(o_actor, o_spec) then score(5) endif
   END_RULES
   if not(cansee(o_player, o_subject)) then
     printcr("[the] [o_subject] is not here.")
     disagree()
   endif
   if equal(o_subject, o_actor) then
     printcr("Talking to yourself is a sign of pending mental collapse.")
     disagree()
   endif
   if not(cansee(o_actor, o_subject)) then
     printcr("[the] [o_subject] is not here.")
     disagree()
   endif
   if not(testflag(o_subject.f_alive)) then
     printcr("Not surprisingly, [the] [o_subject] does not respond.")
   else
     printcr("Thanks for sharing that.")

 "[o_actor], tell [o_subject] about [o_spec]"
   DISAMBIGUATION_RULES
     if equal(o_subject, o_nst) then score(-10) endif
     if equal(o_spec, o_nst) then score(-10) endif
     if testflag(o_spec.f_seenbefore) then score(5) endif
     if cansee(o_actor, o_spec) then score(5) endif
   END_RULES
   if not(cansee(o_player, o_actor)) then
     printcr("[the] [o_actor] is not here.")
     disagree()
   endif
   if equal(o_actor, o_subject) then
     printcr("That means I would be telling myself something I already know...")
   else
     if not(testflag(o_subject.f_alive)) then
       printcr("You don't really expect me to talk to [a] [o_subject], do you?")
     else
       printcr("Really, there's nothing to tell about [the] [o_spec].")
  
  DEFAULT
    printcr("I only understood you as far as wanting to tell something.")
    if testflag(o_player.f_verb_help) then
      printcr("")
      Printcr("Examples of the syntaxes I understand are:")
      printcr("  'tell Fred about the brass key'")
      printcr("  'Fred, tell me about the brass key'")
      printcr("(to turn off these help messages, type 'help 1')")

ENDVERB

