
$COMMON_FLAGS
 f_examined = 0
 f_key      = 0

$VERB use
 "use [o_subject]"
   if not(testflag(o_subject.f_examined)) then
     if try(l_location, 0, "examine [o_subject]") then
       # '0' means print output from the command
       # '1' means mute
       setflag(o_subject.f_examined)
       agree()
     endif
   else
     if try(l_location, 0, "get [o_subject]") then
       agree()

 "use [o_subject] with [o_spec]"
   if testflag(o_spec.f_alive) then
     if testflag(o_subject.f_alive) then
       if try(l_location, 0, "ask [o_spec] about [o_subject]") then
         agree()
       endif
     else
       if try(l_location, 0, "give [o_spec] to [o_subject]") then
         agree()
       endif
     endif
     agree()
   endif
   if testflag(o_spec.f_locked) and testflag(o_subject.f_key) then
     if try(l_location, 0, "unlock [o_spec] with [o_subject]") then
       agree()
     endif
   else
     if testflag(o_spec.f_container) then
       if try(l_location, 0, "put [o_subject] in [o_spec]") then
         agree()
       endif
     else
       if try(o_actor, 0, "put [o_subject] on [o_spec]") then
         agree()
       endif
     endif
   endif
 DEFAULT
   agree() # do nothing

ENDVERB



   